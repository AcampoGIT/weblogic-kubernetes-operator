# Copyright 2017, 2018, Oracle Corporation and/or its affiliates.  All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at http://oss.oracle.com/licenses/upl.

#
#  Wercker build file for Oracle WebLogic Server Kubernetes Operator
#

box:
  id: store/oracle/serverjre
  username: $DOCKER_USERNAME
  password: $DOCKER_PASSWORD
  tag: 8

# This is the main build pipeline that builds the codebase and runs unit tests.
build:
  steps:
    - script:
        name: Hello
        code: |
          echo "Building Oracle WebLogic Server Kubernetes Operator..."
    - script:
      name: Install pre-reqs
      code: |
        yum -y install tar gzip
    - java/maven:
        goals: clean install
        debug: true
        version: 3.5.2
        cache_repo: true

# RUN mkdir /operator
# ENV PATH=$PATH:/operator
#
# COPY src/main/scripts/* /operator/
# ADD target/weblogic-operator-0.1.0-alpha-SNAPSHOT.jar /operator/weblogic-operator.jar
#
# WORKDIR /operator/
#
# CMD ["operator.sh"]


# This pipeline runs the integration tests against a real k8s cluster.
integration-test:
  steps:
    - kubectl:
        server: $KUBERNETES_MASTER
        token: $KUBERNETES_TOKEN
        insecure-skip-tls-verify: true
        command: get all

# This pipeline promotes the docker image
promote-image:
  steps:
    - script:
      name: echo
      code: |
        echo "I don't do anything yet"
